-- Atin PS
-- CP26 -> Puncak -> Rejoin (same private if reservedCode available) -> Auto-exec

-- ====== CONFIG ======
local PRIVATE_PLACE_ID = 123224294054165   -- PlaceId private Atin kamu
local AUTO_URL         = "https://raw.githubusercontent.com/LlyXCode-gif/LlyXCode/refs/heads/main/AtinVIP" -- script kamu (RAW)
local OFFSET_Y         = 0
local DELAY            = 1
local REPEAT_26        = 1
local REPEAT_PUNC      = 1
local ASK_DELAY        = 1

-- Posisi ATIN
local POS_CP26   = Vector3.new(625.56, 1799.20, 3432.68)
local POS_PUNCAK = Vector3.new(782.69, 2155.87, 3915.90)

-- ====== SERVICES ======
local Players         = game:GetService("Players")
local TeleportService = game:GetService("TeleportService")
local player          = Players.LocalPlayer

repeat task.wait() until game:IsLoaded()

-- ====== HELPERS ======
local function hrp()
    local c = player.Character or player.CharacterAdded:Wait()
    return c:WaitForChild("HumanoidRootPart")
end

local function zeroVelocities(char)
    for _, v in ipairs(char:GetDescendants()) do
        if v:IsA("BasePart") then
            v.AssemblyLinearVelocity  = Vector3.new(0,0,0)
            v.AssemblyAngularVelocity = Vector3.new(0,0,0)
        end
    end
end

local function tpInstant(pos)
    local c = player.Character or player.CharacterAdded:Wait()
    zeroVelocities(c)
    hrp().CFrame = CFrame.new(pos + Vector3.new(0, OFFSET_Y, 0))
end

local function queueAuto(url)
    local q = queue_on_teleport
        or (syn and syn.queue_on_teleport)
        or (fluxus and fluxus.queue_on_teleport)
        or (KRNL_LOADED and queue_on_teleport)
        or (getgenv and getgenv().queue_on_teleport)
    if q and type(q) == "function" and url and url ~= "" then
        q(('loadstring(game:HttpGet("%s"))()'):format(url))
    end
end

-- ====== RUN: CP26 -> Puncak ======
for i=1, REPEAT_26 do tpInstant(POS_CP26);   task.wait(DELAY) end
for i=1, REPEAT_PUNC do tpInstant(POS_PUNCAK); task.wait(DELAY) end

-- Auto-exec setelah teleport berikutnya
queueAuto(AUTO_URL)

-- ====== REJOIN (same private jika ada reservedCode) ======
task.wait(ASK_DELAY)

local ok, err = pcall(function()
    -- Ambil reservedCode dari cara kamu masuk sekarang
    local jd = player:GetJoinData()
    local td = jd and jd.TeleportData
    local code = td and td.reservedCode

    if code and code ~= "" then
        -- Rejoin exact instance tanpa 773
        local opts = Instance.new("TeleportOptions")
        opts:SetTeleportData({ reservedCode = code, via = "RzMods-Client" })
        TeleportService:TeleportToPrivateServer(PRIVATE_PLACE_ID, code, {player}, nil, opts)
    else
        -- Ga ada code (join langsung VIP) -> fallback rejoin place
        TeleportService:Teleport(PRIVATE_PLACE_ID, player)
    end
end)

if not ok then
    warn("[RzMods][Rejoin] gagal:", err)
    -- Last fallback kecil: coba rejoin place biasa sekali lagi
    pcall(function() TeleportService:Teleport(PRIVATE_PLACE_ID, player) end)
end
